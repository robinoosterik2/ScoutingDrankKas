services:
  - type: web
    name: Drankkas
    runtime: node
    region: frankfurt
    plan: starter
    rootDir: app

    # Build settings
    buildCommand: pnpm install --frozen-lockfile && pnpm prisma generate && pnpm run build
    startCommand: sh -c "pnpm exec prisma migrate deploy || pnpm exec prisma db push; node .output/server/index.mjs"

    # Persistent disk for SQLite
    disk:
      name: sqlite-data
      mountPath: /var/data
      sizeGB: 1

    # Auto-deploy and branch settings
    autoDeploy: true
    branch: master
